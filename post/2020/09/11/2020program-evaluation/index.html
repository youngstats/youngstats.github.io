<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Program Evaluation and Causal Inference for Histogram Data | YoungStatS</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">

  </head>

  <body class="page">
    <nav class="header">
      <div class="banner">
<a href="/" class="text">
<div class="yourfancytitle"> YoungStatS </div> 
</a>
</div>

      <div class="head-meta">
      
        <span><a href="/">&larr; Back to Home</a></span>
        <span class="date">2020-09-11</span>
        
        
        
          
        
        
        
        
      
      </div>
    </nav>
    
    <footer>
<script src="//yihui.org/js/math-code.js"></script>
<script async
src="cdnjs.cloudflare.com/ajax/libs/mathjax/3.1.0?config=TeX-MML-AM_CHTML">
</script>
<div class="footer">
  <ul class="menu">
    
    <li><a href="/"><span data-hover="Home">Home</span></a></li>
    
    <li><a href="/about/"><span data-hover="About">About</span></a></li>
    
    <li><a href="/seminars/"><span data-hover="Online Seminars">Online Seminars</span></a></li>
    
    <li><a href="/categories/"><span data-hover="Categories">Categories</span></a></li>
    
  </ul>
  
</div>
</footer>

<div class="container">
<article>
<div class="article-meta">

  <div class="categories">
  
    <a href="/categories/statistics">statistics</a>
  
     &hercon; <a href="/categories/post">post</a>
  
     &hercon; <a href="/categories/casual-inference">casual inference</a>
  
  </div>

  <h1><span class="title">Program Evaluation and Causal Inference for Histogram Data</span></h1>

  
  <h3 class="author">Andrej Srakar et al.
</h3>
  

  
  

</div>



<main>



<p><strong>Program Evaluation and Causal Inference for Histogram Data</strong></p>
<p>By Andrej Srakar, Valentina Prevolnik-Rupel and Tjaša Bartolj</p>
<p><em>Analysis of compositions, intervals, histograms, distributions and
functions has become more and more common in contemporary statistics and
econometrics. Despite several types of regressions existing for symbolic
data, causal inference has not been studied so far adequately. We
develop a statistical theory for using instrumental variables with
symbolic distributional data, related to the prevailing usage of
regressions in such situations, the so-called "two components" Irpino
and Verde model. We apply the findings to a pressing problem in the
analysis of the aging process: the effects of retirement on health
outcomes.</em></p>
<p>2SLS estimation is a common procedure to correct for the problems of
endogeneity in econometrics and statistics. It may feature more
instruments than endogenous variables. 2SLS is the minimum variance
(under homoskedasticity) linear combination of the potential IV
estimators. It is also the GMM estimator using the full set of
orthogonality conditions implied by
<span class="math inline">\(E{\lbrack z}_{i}\varepsilon_{i}\rbrack = 0\)</span>. General formula for the
2SLS estimator reads as:</p>
<p><span class="math display">\[{\widehat{\beta}}_{2SLS} = \left( X^{&#39;}PZX \right)^{- 1}\left( X^{&#39;}PZY \right) = \beta + \left( X^{&#39;}PZX \right)^{- 1}\left( X^{&#39;}PZ\varepsilon \right)\]</span></p>
<p>where <span class="math inline">\(P_{Z} = Z{(Z^{&#39;}Z)}^{- 1}Z&#39;\)</span> is the projection matrix onto <span class="math inline">\(Z\)</span><em>.</em>
Under general conditions the estimator is generally consistent and
asymptotically normal with estimable covariance matrix.</p>
<p>Regression models for interval data consist of multiple types, such as
Methods based on symbolic covariance definitions (Billard and Diday,
2000; 2006; Xu, 2010), minmax method (Billard and Diday, 2002), center
and range method (Lima Neto and De Carvalho, 2008), center and range
least absolute deviation regression method (Maia and Carvalho, 2008),
constrained center and range method (Lima Neto and De Carvalho, 2010),
Lasso IR method (Giordani, 2014), bivariate symbolic regression models
(Lima Neto et al, 2011), linear regression models for symbolic interval
data using PSO algorithm (Yang et al, 2011), Monte Carlo method (Ahn et
al, 2012), radial basis function networks (Su et al, 2012), copula
interval regression method (Neto et al, 2012), interval distributional
model (Dias and Brito, 2012), exponential-type kernel robust regression
for interval-valued data (De Carvalho, Lima Neto, da Nobrega, 2018) and
symbolic polygonal regression (Silva et al, 2019).</p>
<p>Regression models for histogram data consist of three types. First model
of Billard and Diday (2006) considers the set of histogram-valued data
<span class="math inline">\(\left\{ Y\left( j \right),X_{1}\left( j \right),X_{2}\left( j \right),\ldots,X_{p}\left( j \right) \right\}_{j = 1}^{m}\)</span>
and models the histogram regression as:</p>
<p><span class="math display">\[Y\left( j \right) = b_{0} + b_{1}X_{1}\left( j \right) + b_{2}X_{2}\left( j \right) + \ldots + b_{p}X_{p}\left( j \right) + e(j)\]</span></p>
<p>The estimation of the parameters is an adaptation of the solution
obtained by the Least Square estimation method for the classical linear
model where the symbolic definitions of variance and covariance are
applied. Its problem lies in that the methods based on symbolic
covariance definitions do not predict distributions from other
distributions.</p>
<p>Second model of Dias and Brito (2011) model an inverse quantile
function:</p>
<p><span class="math display">\[\Psi_{Y\left( j \right)}^{- 1}\left( t \right) = \Psi_{\widehat{Y}\left( j \right)}^{- 1}\left( t \right) + e_{j}(t)\]</span></p>
<p>where <span class="math inline">\(\Psi_{\widehat{Y}\left( j \right)}^{- 1}\left( t \right)\)</span> is the
predicted quantile function for unit <span class="math inline">\(j\)</span>, obtained from:</p>
<p><span class="math inline">\(\Psi_{\widehat{Y}\left( j \right)}^{- 1}\left( t \right) = v + a_{1}\Psi_{X_{1}\left( j \right)}^{- 1}\left( t \right) - b_{1}\Psi_{X_{1}\left( j \right)}^{- 1}\left( 1 - t \right) + a_{2}\Psi_{X_{2}\left( j \right)}^{- 1}\left( t \right) - b_{2}\Psi_{X_{2}\left( j \right)}^{- 1}\left( 1 - t \right) + \ldots + a_{p}\Psi_{X_{p}\left( j \right)}^{- 1}\left( t \right) - b_{p}\Psi_{X_{p}\left( j \right)}^{- 1}\left( 1 - t \right)\)</span> </p>
<p>Its regression problem can be transformed into minimization of:</p>
<p><span class="math display">\[SSE = \sum_{j = 1}^{m}{d_{w}^{2}(\Psi_{Y\left( j \right)}^{- 1}\left( t \right),}\Psi_{\widehat{Y}\left( j \right)}^{- 1}\left( t \right)) = \sum_{j = 1}^{m}{\sum_{i = 1}^{n}{(p_{i}}{|(c_{{Y\left( j \right)}_{i}} - c_{{\widehat{Y}\left( j \right)}_{i}})|)}^{2}}\ \]</span></p>
<p><span class="math display">\[\text{s.t.~}a_{j},b_{j} \geq 0\]</span></p>
<p><span class="math display">\[v\mathbb{\in R}\]</span></p>
<p>Third model is from Irpino and Verde (2012). They use Cuesta-Albertos et
al. (1997) decomposition of the squared Wasserstein distance into:</p>
<p><span class="math display">\[d_{W}^{2}\left( f,g \right) = {(\overline{x_{f}} - \overline{x_{g}})}^{2} + \int_{0}^{1}{{\lbrack x_{f}^{c}\left( t \right) - x_{g}^{c}\left( t \right)\rbrack}^{2}\text{dt}}\]</span></p>
<p>Irpino and Verde assume the following regression model:</p>
<p><span class="math display">\[y_{i}\left( t \right) = \beta_{0} + \sum_{j = 1}^{p}\beta_{j}{\overline{x}}_{\text{ij}} + \sum_{j = 1}^{p}\gamma_{j}x_{\text{ij}}^{c}\left( t \right) + e_{i}\left( t \right),\ \ \ \ \ \ \ \ \ \forall t \in \lbrack 0,1\rbrack\]</span></p>
<p>This finally separates into two separate solution problems which can be
solved by ordinary least squares approach:</p>
<p><span class="math display">\[\overline{Y} = {\overline{X}}_{+}B + \overline{e}\]</span></p>
<p><span class="math display">\[\underset{B}{\text{argmin}}{\text{SSE}\left( B \right)} = {\overline{e}}^{T}\overline{e} = \left\lbrack \overline{Y} - {\overline{X}}_{+}B \right\rbrack^{T}\left\lbrack \overline{Y} - {\overline{X}}_{+}B \right\rbrack\]</span></p>
<p> </p>
<p><span class="math display">\[Y^{c} = X^{c}\Gamma + e^{c}\]</span></p>
<p><span class="math display">\[\underset{\Gamma}{\text{argmin}}{\text{SSE}\left( \Gamma \right)} = {(e^{c})}^{T}e^{c} = \left\lbrack Y^{c} - X^{c}\Gamma \right\rbrack^{T}\left\lbrack Y^{c} - X^{c}\Gamma \right\rbrack\]</span></p>
<p><span class="math display">\[\text{s.t.~}\gamma_{j} \geq 0,\ j = 1,\ldots,p\]</span></p>
<p>Our instrumental variable/2SLS approaches for the derivation of the new
estimators rely on transformations based on above approaches. For the
Billard-Diday model, the solution is immediate and follow the basic OLS
algebra.</p>
<p>For the Dias-Brito model we use transformation of the common 2SLS
estimator:</p>
<p><span class="math display">\[{\widehat{b}}_{2SLS} = {\lbrack X^{&#39;}Z\left( Z^{&#39;}Z \right)^{- 1}Z^{&#39;}X\rbrack}^{- 1}\lbrack X^{&#39;}Z\left( Z^{&#39;}Z \right)^{- 1}Z^{&#39;}y\rbrack\]</span></p>
<p>using</p>
<p><span class="math display">\[\left\langle x_{f}\left( t \right),x_{g}(t) \right\rangle = \int_{0}^{1}{x_{f}\left( t \right)} \bullet x_{g}\left( t \right)dt = \rho\left( x_{f},x_{g} \right) \bullet s_{f} \bullet s_{g} + \overline{x_{f}} \bullet \overline{x_{g}}\]</span></p>
<p>The estimation proceeds using constrained 2SLS problem:</p>
<p><span class="math display">\[\min{f(a_{1}},b_{1},\ldots,a_{p},b_{p},v) = \frac{1}{2}\mathbf{b&#39;}\mathbf{H}_{\mathbf{1}}\mathbf{b} + \mathbf{w}\mathbf{&#39;b} + K\]</span></p>
<p><span class="math display">\[\text{s.t.~}a_{j},b_{j} \geq 0\]</span></p>
<p><span class="math display">\[v\mathbb{\in R}\]</span></p>
<p>For the Irpino-Verde model we exploit that :</p>
<p><span class="math inline">\({{\overline{X}}_{+}}^{T}X^{c} = 0_{\left( p + 1 \right) \times p}\)</span>,
<span class="math inline">\({{\overline{X}}_{+}}^{T}Y = {{\overline{X}}_{+}}^{T}\overline{Y}\)</span>,
<span class="math inline">\({X^{c}}^{T}Y = {X^{c}}^{T}Y^{c}\)</span></p>
<p>and use</p>
<p><span class="math display">\[\left\langle x_{f}\left( t \right),x_{g}(t) \right\rangle = \int_{0}^{1}{x_{f}\left( t \right)} \bullet x_{g}\left( t \right)dt = \rho\left( x_{f},x_{g} \right) \bullet s_{f} \bullet s_{g} + \overline{x_{f}} \bullet \overline{x_{g}}\]</span></p>
<p>The 2SLS estimator in this case then transforms to:</p>
<p><span class="math display">\[({\overline{X}}_{+}&#39;P_{Z}{\overline{X}}_{+})^{- 1}\overline{X}_{+}&#39;P_{Z}\overline{Y} + {({X^{c}}^{\prime}P_{Z}X^{c})}^{- 1}{X^{c}}^{\prime}P_{Z}Y^{c} + AP_{Z}\overline{Y} + DP_{Z}Y^{c}\]</span></p>
<p>It can be shown, as in the usual 2SLS case, that also this estimator is
consistent and asymptotically normal.</p>
<p>Simulation below shows the properties of the three new estimator
approaches and shows It shows coverage probabilities and standard errors
of different methods based on 10000 simulated data sets and
corresponding 1000 resamples.</p>
<p><img src="/post/2020program-evaluation_files/figure-html/tab1.png" /></p>
<p>Our regression application relies on data from Wave 6 of the Survey of
Health, Ageing and Retirement in Europe (SHARE) and analyzes the
relationship between retirement decisions and health status of the
elderly.</p>
<p><img src="/post/2020program-evaluation_files/figure-html/tab2.png" /></p>
<p>Relevance of the approach are clear – this is the first causal
inference analysis in general for symbolic data and derives several new
estimators. The results allow richer assessment of causal effects for
any causal analysis in future – many problems in health field are
„functional" by nature and would benefit from aggregation approaches
from all areas of complex data analysis.</p>
<p>Extensions of the approach are numerous. It can be extended to different
IV frameworks – definition of IV used is an econometric textbook one.
Extensions are possible to plethora of causal inference possibilities –
none of them have so far been studied using SDA or, largely, FDA (with
the exception of functional mediation analysis and FILR)). It could also
refer to using symbolic likelihood approaches, developed by e.g.
Beranger et al. (2018) and Emilion (2019). Necessity is development of
the tests for endogeneity, extensions to multiple endogeneous variables
(pairs of quantiles) and weak instruments (generalization of LIML) for
those cases. Finally, it can be extended to manifold-valued data,
topological data, geometric data, compositional data, directional data
and combined with machine learning approaches, being an important object
of research of present day causal inference.</p>
<p><strong>The article is based on:</strong></p>
<p>Andrej Srakar, Valentina Prevolnik Rupel, Tjaša Bartolj: Program
Evaluation and Causal Inference for Histogram Data: Estimation of the
Effects of Retirement on Health Outcomes. Manuscript under review in
Computational Statistics &amp; Data Analysis.</p>
<p><strong>About the authors:</strong></p>
<p>Andrej Srakar, Institute for Economic Research (IER) and School of
Economics and Business, University of Ljubljana, Slovenia,
<a href="mailto:andrej.srakar@ef.uni-lj.si"><span class="underline">andrej.srakar@ef.uni-lj.si</span></a></p>
<p>Valentina Prevolnik Rupel, Institute for Economic Research (IER),
<a href="mailto:rupelv@ier.si"><span class="underline">rupelv@ier.si</span></a></p>
<p>Thaša Bartolj, Institute for Economic Research (IER),
<a href="mailto:rupelv@ier.si"><span class="underline">rupelv@ier.si</span></a></p>

</main>


















<nav class="post-nav">
  <span class="nav-prev"></span>
  <span class="nav-next"><a href="/post/2020/09/10/hello-world/">We&#39;re online &rarr;</a></span>
</nav>



</article>
</div>

<script async src="//yihui.name/js/center-img.js"></script>
 


<script src="//yihui.name/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>






</body>
</html>

